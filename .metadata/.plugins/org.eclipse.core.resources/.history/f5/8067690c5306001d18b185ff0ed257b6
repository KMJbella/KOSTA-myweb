package com.my.repository;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import com.my.dto.Customer;
import com.my.exception.AddException;
import com.my.exception.FindException;
import com.my.sql.MyConnection;

public class CustomerOracleRepository implements CustomerRepository {

	@Override
	public Customer selectByIdAndPwd(String id, String pwd) throws FindException {
		//DB와 연결
				Connection con = null;
				//SQL송신
				PreparedStatement pstmt = null;
				//송신결과
				ResultSet rs = null;
				//응답결과
				String result = "{\"status\":0}";
				try {
					con = MyConnection.getConnection();
					String selectIdNPwdSQL = "SELECT * FROM customer WHERE id=? AND pwd=?";
					pstmt = con.prepareStatement(selectIdNPwdSQL);
					pstmt.setString(1, id);
					pstmt.setString(2, pwd);
					rs = pstmt.executeQuery();
//					rs.next();
					if(rs.next()) { //로그인 성공인 경우
						new Customer(rs.getString("id"), rs.getString("pwd"), rs.getString("name"), rs.getString("address"),
								rs.getInt("status"), rs.getString("buildingno"));
					}
					throw new FindException("고객이 없습니다");
					
					} catch (Exception e) {
					throw new FindException(e.getMessage());
					
					} finally {
					MyConnection.close(rs, pstmt, con);
				}

		}

	@Override
	public void insert(Customer customer) throws AddException {
		//DB와 연결
		Connection con = null;
		//SQL송신
		PreparedStatement pstmt = null; //executeUpdate()
		String insertSQL = ""
		try {
			con = MyConnection.getConnection();
			pstmt = con.prepareStatement(insertSQL);
			pstmt.setString(1, customer.getid());
			pstmt.setString(2, pwd);
			rs = pstmt.executeQuery();
//			rs.next();
	}
	}

